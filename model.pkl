models = {}
predictions_return = {} # Menyimpan prediksi dalam bentuk Return

# --- 1. Linear Regression ---
lr = LinearRegression()
lr.fit(X_train_scaled, y_train)
predictions_return['Linear Regression'] = lr.predict(X_test_scaled)
models['Linear Regression'] = lr
print("Linear Regression Selesai.")

# --- 2. Random Forest (Sekarang sudah Optimal!) ---
rf = RandomForestRegressor(
    n_estimators=200,
    max_depth=None,      # Biarkan tumbuh penuh karena fitur sudah bersih
    min_samples_leaf=2,  # Sedikit regularization
    random_state=42
)
rf.fit(X_train, y_train) # RF bisa pakai data non-scaled
predictions_return['Random Forest'] = rf.predict(X_test)
models['Random Forest'] = rf
print("Random Forest Selesai.")

# --- 3. SVR (Support Vector Regression) ---
svr = SVR(kernel='rbf', C=100, gamma=0.1, epsilon=0.001)
svr.fit(X_train_scaled, y_train)
predictions_return['SVR'] = svr.predict(X_test_scaled)
models['SVR'] = svr
print("SVR Selesai.")
